// File: HealthBand.ino
#include <ESP8266WiFi.h>
#include <FirebaseESP8266.h>
#include <DHT.h>

#define WIFI_SSID "YOUR_WIFI"
#define WIFI_PASS "YOUR_PASS"
#define FIREBASE_HOST "your-proj.firebaseio.com"
#define FIREBASE_AUTH "YOUR_AUTH"

#define PULSE_PIN A0
#define DHTPIN D2
#define DHTTYPE DHT11

FirebaseData fbdo;
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);
  dht.begin();
  WiFi.begin(WIFI_SSID, WIFI_PASS);
  while (WiFi.status() != WL_CONNECTED) delay(500);
  Firebase.begin(FIREBASE_HOST, FIREBASE_AUTH);
}

int readPulse() {
  // Very simple pulse demo: read analog value and map to bpm roughly
  int val = analogRead(PULSE_PIN);
  // For production use, use a pulse sensor library
  int bpm = map(val, 300, 900, 50, 120);
  if (bpm < 30) bpm = 0;
  return bpm;
}

void loop() {
  int bpm = readPulse();
  float temp = dht.readTemperature();
  float hum = dht.readHumidity();

  Serial.printf("BPM:%d T:%.1f H:%.1f\n", bpm, temp, hum);
  Firebase.setInt(fbdo, "/health/bpm", bpm);
  Firebase.setFloat(fbdo, "/health/temperature", temp);
  Firebase.setFloat(fbdo, "/health/humidity", hum);

  delay(5000);
}
